C:\Users\t-as8\AppData\Local\Programs\Python\Python39\python.exe D:\git\sber-agent\sber-agents\02-llm-api\src\bot.py 
┌──────────────────────────────── 📖 Справка ─────────────────────────────────┐
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │                            🤖 CLI LLM Бот                             │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│  Образовательный проект для работы с LLM через OpenRouter API.              │
│                                                                             │
│  Доступные команды:                                                         │
│                                                                             │
│   • /exit - выход из программы                                              │
│   • /clear - очистить историю диалога                                       │
│   • /stats - показать статистику сессии                                     │
│   • /help - показать эту справку                                            │
│                                                                             │
│  Начните диалог с вопроса или сообщения!                                    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
✓ Системный промпт активен

👤 Вы:  Привет как дела?
┌─────────────────────────────────── 👤 Вы ───────────────────────────────────┐
│                                                                             │
│  Привет как дела?                                                           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
┌─────────────────────────────── 🤖 Ассистент ────────────────────────────────┐
│                                                                             │
│  Привет! У меня всё хорошо, спасибо.                                        │
│  Какие темы по Python тебя интересуют сегодня?                              │
│  Есть конкретная задача, над которой ты работаешь, или просто хотелось бы   │
│  попрактиковать что‑то новое?                                               │
│                                                                             │
│  Если у тебя есть пример кода, с которым возникли сложности, можешь         │
│  показать – я подскажу, в чём может быть причина и как подойти к решению.   │
│  Если же ты просто хочешь поэкспериментировать, расскажи, что интересного   │
│  тебе хотелось бы попробовать? 🚀                                           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
               📊 Метрики ответа               
┌───────────────────┬─────────────────────────┐
│ Параметр          │ Значение                │
├───────────────────┼─────────────────────────┤
│ Модель            │ openai/gpt-oss-20b:free │
│ Prompt токены     │ 152                     │
│ Completion токены │ 197                     │
│ Всего токены      │ 349                     │
│ Finish reason     │ stop                    │
└───────────────────┴─────────────────────────┘
    🎯 Статистика сессии    
┌───────────────┬──────────┐
│ Параметр      │ Значение │
├───────────────┼──────────┤
│ Сообщений     │ 1        │
│ Всего токенов │ 349      │
└───────────────┴──────────┘

👤 Вы:  Раскажи мне коротко про ai агентов
┌─────────────────────────────────── 👤 Вы ───────────────────────────────────┐
│                                                                             │
│  Раскажи мне коротко про ai агентов                                         │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
┌─────────────────────────────── 🤖 Ассистент ────────────────────────────────┐
│                                                                             │
│                  Что такое AI‑агент (искусственный агент)?                  │
│                                                                             │
│  Агент – это самостоятельный «работник» внутри программы, который:          │
│                                                                             │
│   1 Получает входные данные (состояние мира, события, сообщения от          │
│     пользователя и т.д.).                                                   │
│   2 Приняла решение (выбирает действие, меняет своё состояние).             │
│   3 Выполняет действие (отправляет сообщение, выводит результат, меняет     │
│     переменные и т.д.).                                                     │
│                                                                             │
│  Форма «искусственный» добавляет, что агент использует какую‑то форму       │
│  машинного обучения или интеллектуального процесса, чтобы делать более      │
│  «умные» выборы, чем простая последовательность «если‑то».                  │
│                                                                             │
│                         Коротко о типах AI‑агентов:                         │
│                                                                             │
│                                                                             │
│    Тип                     Как работает            Примеры                  │
│   ───────────────────────────────────────────────────────────────────────   │
│    Rule‑based              Набор «если‑потом»      Чат‑бот на основе        │
│                            правил.                 шаблонов.                │
│    Reinforcement           Агент пытается          Агент в игре (через      │
│    Learning (RL)           максимизировать         OpenAI Gym).             │
│                            награду, пробуя                                  │
│                            действия.                                        │
│    Planning                Агент строит план       Робот, который           │
│                            действий так, чтобы     планирует маршрут.       │
│                            достичь цели.                                    │
│    Hybrid                  Комбинация правил +     Персональный             │
│                            ML.                     ассистент, который       │
│                                                    использует GPT и         │
│                                                    логические правила.      │
│                                                                             │
│                                                                             │
│                              Почему они важны?                              │
│                                                                             │
│   • Автономия: Агент может действовать без постоянного участия человека.    │
│   • Переиспользуемость: Логика агента может применяться в разных            │
│     приложениях.                                                            │
│   • Интерактивность: Идеально для чат‑ботов, игр, виртуальных помощников и  │
│     т.д.                                                                    │
│                                                                             │
│               Как написать простенького AI‑агента на Python?                │
│                                                                             │
│  Ниже пример «глупого» агента, который делает выбор по простому правилу. Я  │
│  не дам готовый «решённый» код, а перечислю шаги, чтобы вы могли сам        │
│  собрать его.                                                               │
│                                                                             │
│   1 Определите цель агента (например, ответить на вопрос пользователя).     │
│   2 Соберите данные, которые агент будет видеть (текст вопроса).            │
│   3 Напишите простое правило (если вопрос содержит слово «привет», ответ    │
│     «Привет! Как дела?»).                                                   │
│   4 Реализуйте цикл (получить ввод → применить правило → вывести ответ).    │
│                                                                             │
│  Если захотите усложнить, можно подключить модель GPT, но сначала           │
│  попробуйте сам написать правила. Это поможет понять структуру агента:      │
│  вход → обработка → выход.                                                  │
│                                                                             │
│                          Как дальше продвигаться?                           │
│                                                                             │
│   • Проверьте: Запустите агент с разными вводами – видите, как он           │
│     реагирует.                                                              │
│   • Добавьте больше правил: Сделайте таблицу «если‑то» более плотной.       │
│   • Интегрируйте обучаемый компонент: Например, сохраните статистику        │
│     частот слов и отталкивайтесь от неё при выборе ответа.                  │
│                                                                             │
│  Пробуйте! В процессе вы поняли будете, какие составляющие помогают         │
│  AI‑агенту работать эффективнее. Если возникнут вопросы по какому‑то шагу,  │
│  спрашивайте – я помогу уточнить. 🚀                                        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
               📊 Метрики ответа               
┌───────────────────┬─────────────────────────┐
│ Параметр          │ Значение                │
├───────────────────┼─────────────────────────┤
│ Модель            │ openai/gpt-oss-20b:free │
│ Prompt токены     │ 284                     │
│ Completion токены │ 745                     │
│ Всего токены      │ 1029                    │
│ Finish reason     │ stop                    │
└───────────────────┴─────────────────────────┘
    🎯 Статистика сессии    
┌───────────────┬──────────┐
│ Параметр      │ Значение │
├───────────────┼──────────┤
│ Сообщений     │ 2        │
│ Всего токенов │ 1378     │
└───────────────┴──────────┘

👤 Вы: С чего мне начать создание своего агента?
┌─────────────────────────────────── 👤 Вы ───────────────────────────────────┐
│                                                                             │
│  С чего мне начать создание своего агента?                                  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
┌─────────────────────────────── 🤖 Ассистент ────────────────────────────────┐
│                                                                             │
│                       🛠️ План запуска своего AI‑агента                       │
│                                                                             │
│  Ниже – «рабочая дорожная карта» с вопросами, которые помогут вам самому    │
│  собрать агента шаг за шагом. Я не покажу готовый код, но расскажу, какой   │
│  фрагмент написать первым и как проверить, что всё работает.                │
│                                                                             │
│                                                                             │
│    Шаг   Что задаётся          Как проверить         Что дальше             │
│   ───────────────────────────────────────────────────────────────────────   │
│    1     Определить цель       Напишите в одном      Сформулируйте          │
│          агента                предложении: «Мой     задачу в конкретном    │
│                                агент делает…»        формате.               │
│    2     Получить вводные и    Какие типы данных     Составьте список       │
│          выходные данные       они будут? Текст,     «вход‑выход».          │
│                                числа, состояние                             │
│                                мира?                                        │
│    3     Выбрать вид агента    Простой «если‑то»,    Для новичка –          │
│                                RL‑агент,             правило‑базированн…    │
│                                планировщик?          позже усложняйте.      │
│    4     Сделать минимальный   Создайте функцию,     Напишите и             │
│          прототип (MVP)        которая получает      запустите локально     │
│                                вход → делает выбор   (можно использовать    │
│                                → возвращает          input()/print()).      │
│                                результат.                                   │
│    5     Тестировать           Смените вход,         Составьте небольшие    │
│                                посмотрите, как       тесты, но без          │
│                                меняется результат.   assert – просто        │
│                                                      печатайте.             │
│    6     Добавить хранение     Переменные, которые   Попробуйте             │
│          состояния             агент «помнит»        реализовать простую    │
│                                (например,            «кеш‑таблицу».         │
│                                предыдущий вопрос).                          │
│    7     Усовершенствовать     Дополним правилами,   Переписывайте          │
│          логику                добавим простую       логику по мере         │
│                                «побочные эффекты».   появления новых        │
│                                                      требований.            │
│    8     Обучаемый компонент   Если хотите,          Составьте набор        │
│                                подключите простую    обучающих данных,      │
│                                модель (например,     обучите модель,        │
│                                sklearn               подключите к           │
│                                классификатор).       агенту.                │
│    9     Интерфейс и           CLI, web‑сервис,      Реализуйте минимум     │
│          развертывание         Telegram‑бот?         для теста, а потом     │
│                                                      добавляйте новые       │
│                                                      интерфейсы.            │
│    10    Наблюдение и          Логи, метрики,        Добавьте простую       │
│          оптимизация           профилирование.       печать «запуск         │
│                                                      агента», а позже       │
│                                                      интегрируйте           │
│                                                      logging.               │
│                                                                             │
│                                                                             │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│                   Вопросы, которые помогут уточнить план                    │
│                                                                             │
│   1 «Что именно я хочу, чтобы агент делал?»                                 │
│     Пример: «Ответить на вопросы о погоде» или «Распознать объекты на       │
│     изображении».                                                           │
│   2 «Какие данные я могу давать агенту?»                                    │
│     Текст? Изображения? Состояние игры?                                     │
│   3 «Какой уровень интеллекта мне нужен?»                                   │
│      • Обычная таблица правил.                                              │
│      • Модель машинного обучения (например, sklearn, transformers).         │
│      • Полностью обучаемый RL-агент.                                        │
│   4 «Как агент будет получать и отдавать информацию?»                       │
│      • Через командную строку (input(), print()).                           │
│      • Через API (REST, WebSocket).                                         │
│      • Через чат‑бота (Telegram, Discord).                                  │
│   5 «Как я проверю, что агент работает?»                                    │
│      • Набор ожидаемых входов/выходов.                                      │
│      • Тесты «пользователя» (через unittest позже).                         │
│                                                                             │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│                   Мини‑пример «если‑то» (только в голове)                   │
│                                                                             │
│                                                                             │
│   if "привет" in вопрос:                                                    │
│       ответ = "Привет! Как дела?"                                           │
│   elif "погода" in вопрос:                                                  │
│       ответ = "Мне нужен API‑ключ, но можно проверить, какие сегодня        │
│   прогнозы."                                                                │
│   else:                                                                     │
│       ответ = "Извини, не понял."                                           │
│                                                                             │
│                                                                             │
│  Подумайте, как бы вы реализовали такую логику? Какие переменные нужны,     │
│  где кладём их? Какие проверки добавим? Попробуйте написать простую         │
│  функцию process_question(question: str) -> str и протестировать с разными  │
│  строками.                                                                  │
│                                                                             │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                 Что дальше?                                 │
│                                                                             │
│   1 Сделайте первый прототип – простая функция, которая реагирует на        │
│     несколько ключевых слов.                                                │
│   2 Запустите его в интерпретаторе, задайте несколько вопросов.             │
│   3 Разберитесь, где хочется улучшить (например, добавить поддержку         │
│     нескольких языков).                                                     │
│   4 Постепенно переходите к более сложным компонентам (модели,              │
│     планировщики).                                                          │
│                                                                             │
│  Если на каком‑то этапе вы застряли или хотите уточнить, как подключить     │
│  конкретную библиотеку, дайте знать! 🚀                                     │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
               📊 Метрики ответа               
┌───────────────────┬─────────────────────────┐
│ Параметр          │ Значение                │
├───────────────────┼─────────────────────────┤
│ Модель            │ openai/gpt-oss-20b:free │
│ Prompt токены     │ 1018                    │
│ Completion токены │ 1188                    │
│ Всего токены      │ 2206                    │
│ Finish reason     │ stop                    │
└───────────────────┴─────────────────────────┘
    🎯 Статистика сессии    
┌───────────────┬──────────┐
│ Параметр      │ Значение │
├───────────────┼──────────┤
│ Сообщений     │ 3        │
│ Всего токенов │ 3584     │
└───────────────┴──────────┘

👤 Вы:  Посоветуй бесплатную llm для тестирования агента
┌─────────────────────────────────── 👤 Вы ───────────────────────────────────┐
│                                                                             │
│  Посоветуй бесплатную llm для тестирования агента                           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
┌─────────────────────────────── 🤖 Ассистент ────────────────────────────────┐
│                                                                             │
│           Бесплатные LLM — ваш «первый» кандидат для тестирования           │
│                                                                             │
│                                                                             │
│                                                    Что полезно — для        │
│    Пример                  Где взять               чего                     │
│   ───────────────────────────────────────────────────────────────────────   │
│    LLaMA 2‑7B (Meta)       huggingface.co/meta-…   Маленькая и быстрая      │
│                                                    модель, отлично          │
│                                                    подходит для             │
│                                                    “прокладки” простых      │
│                                                    агентов.                 │
│    Mistral 7B              mistralai/Mistral-7B…   Очень компактная и       │
│                                                    крауд‑дженеративная,     │
│                                                    хорошо понимает          │
│                                                    контекст.                │
│    Open‑Chat‑NeoX 20B      Hugging Face Spaces     Сложнее, но более        │
│                            или                     мощная (20 МБ            │
│                            EleutherAI/pythia-1b    параметров).             │
│                            (для меньшего веса)                              │
│    Stable‑Vicuna‑13B       stable-foundation/Vi…   Похожая по стиле на      │
│                                                    Vicuna от LLaMA, но      │
│                                                    бесплатен.               │
│    Claude‑Instant (Meta)   Anthropic/Claude-2      Если хотите «чистый»     │
│                            (через API, иногда      валидационный API, но    │
│                            встречаются             в основном платный.      │
│                            бесплатные токены)                               │
│                                                                             │
│                                                                             │
│  ▌ Полезный совет: Для большинства «первых шагов» достаточно моделей в      │
│  ▌ диапазоне 7‑13 МБ параметров (LLaMA 2‑7B, Mistral 7B, Vicuna‑13B).       │
│  ▌ Они работают быстро на ноутбуке с GPU RTX 3060+ (или даже                │
│  ▌ CPU‑мгновенно, если используете Quantization).                           │
│                                                                             │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│                Как сделать подключение (пример / подсказка)                 │
│                                                                             │
│                                                                             │
│   pip install transformers torch                                            │
│                                                                             │
│                                                                             │
│                                                                             │
│   from transformers import AutoModelForCausalLM, AutoTokenizer              │
│   import torch                                                              │
│                                                                             │
│   model_name = "meta-llama/Llama-2-7b"   # ← меняем на нужную ссылку        │
│                                                                             │
│   tokenizer = AutoTokenizer.from_pretrained(model_name,                     │
│   trust_remote_code=True)                                                   │
│   model     = AutoModelForCausalLM.from_pretrained(                         │
│       model_name,                                                           │
│       torch_dtype=torch.float16,                                            │
│       device_map="auto",                                                    │
│       trust_remote_code=True                                                │
│   )                                                                         │
│                                                                             │
│   prompt = "Привет, чем могу помочь?"                                       │
│   inputs = tokenizer(prompt, return_tensors="pt")                           │
│   with torch.no_grad():                                                     │
│       outputs = model.generate(**inputs, max_length=128)                    │
│   print(tokenizer.decode(outputs[0], skip_special_tokens=True))             │
│                                                                             │
│                                                                             │
│                             Что делать дальше?                              │
│                                                                             │
│   1 Тестируйте: попробуйте задать разные вопросы, убедись, что модель       │
│     понимает шаблоны.                                                       │
│   2 Интегрируйте к агенту: вынеси эту логическую часть в функцию, которую   │
│     ваш агент будет вызывать как «рассуждение».                             │
│   3 Управляйте токенами: добавь логику подсчёта токенов, чтобы не           │
│     превышать лимиты (у бесплатных API иногда лимит 50 К токенов в час).    │
│   4 Оптимизируй: если модель работает медленно, применяй int8 / int4        │
│     квантизацию (например, через bitsandbytes).                             │
│                                                                             │
│  ▌ Помните: начни с простых вопросов, а потом постепенно усложняй           │
│  ▌ сценарии. Если модель «залипает» в текст, добавь явный                   │
│  ▌ «prompt‑engineering» (напиши, чтобы она отвечала кратко, уточняла        │
│  ▌ требования и т.д.).                                                      │
│                                                                             │
│  Если понадобится помощь в настройке квантования, работе с Hugging Face     │
│  API или создании тестов для вашего агента – спрашивайте! 🚀                │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
               📊 Метрики ответа               
┌───────────────────┬─────────────────────────┐
│ Параметр          │ Значение                │
├───────────────────┼─────────────────────────┤
│ Модель            │ openai/gpt-oss-20b:free │
│ Prompt токены     │ 2104                    │
│ Completion токены │ 942                     │
│ Всего токены      │ 3046                    │
│ Finish reason     │ stop                    │
└───────────────────┴─────────────────────────┘
    🎯 Статистика сессии    
┌───────────────┬──────────┐
│ Параметр      │ Значение │
├───────────────┼──────────┤
│ Сообщений     │ 4        │
│ Всего токенов │ 6630     │
└───────────────┴──────────┘

👤 Вы: /exit
👋 До свидания!

📊 Финальная статистика сессии:

📈 Статистика текущей сессии:
╔═════════════════════╦═════════════════════════╗
║ Метрика             ║ Значение                ║
╠═════════════════════╬═════════════════════════╣
║ Модель              ║ openai/gpt-oss-20b:free ║
║ Сообщений в сессии  ║ 4                       ║
║ Сообщений в истории ║ 9                       ║
║ Prompt токены       ║ 3558                    ║
║ Completion токены   ║ 3072                    ║
║ Всего токены        ║ 6630                    ║
╚═════════════════════╩═════════════════════════╝


Process finished with exit code 0
